CREATE TABLE `messages` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '消息ID',
  `msg_id` varchar(50) NOT NULL COMMENT '消息唯一标识',
  `conversation_id` varchar(64) NOT NULL COMMENT '会话ID',
  `sender_id` bigint(20) NOT NULL COMMENT '发送者ID',
  `receiver_type` tinyint(1) NOT NULL COMMENT '接收者类型: 0-个人, 1-群组',
  `receiver_id` bigint(20) NOT NULL COMMENT '接收者ID',
  `content_type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '内容类型: 0-文本, 1-图片, 2-语音, 3-视频, 4-文件, 5-位置',
  `content` text NOT NULL COMMENT '消息内容',
  `extra` text DEFAULT NULL COMMENT '附加信息(JSON格式)',
  `send_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '发送时间',
  `status` tinyint(1) DEFAULT '0' COMMENT '状态: 0-未发送, 1-已发送, 2-已送达, 3-已读, 4-已撤回, 5-已删除',
  `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `idx_msg_id` (`msg_id`),
  KEY `idx_conversation_id` (`conversation_id`),
  KEY `idx_sender_id` (`sender_id`),
  KEY `idx_receiver` (`receiver_type`,`receiver_id`),
  KEY `idx_send_time` (`send_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='消息表';